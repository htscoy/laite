import{eventHandler as d,toWebRequest as p}from"@tanstack/start-server-core";const P=[{path:"/__root",filePath:"/Users/hetenho/own/laite/src/routes/__root.tsx"},{path:"/",filePath:"/Users/hetenho/own/laite/src/routes/index.tsx"},{path:"/settings",filePath:"/Users/hetenho/own/laite/src/routes/settings.tsx"},{path:"/device/add",filePath:"/Users/hetenho/own/laite/src/routes/device/add.tsx"}],m=["GET","POST","PUT","PATCH","DELETE","OPTIONS","HEAD"];function w(o){return d(async n=>{const s=p(n);return await o({request:s})})}function R(o,n){const s=o.pathname.split("/").filter(Boolean),l=n.sort((e,t)=>{const r=e.routePath.split("/").filter(Boolean);return t.routePath.split("/").filter(Boolean).length-r.length}).filter(e=>{const t=e.routePath.split("/").filter(Boolean);return s.length>=t.length});for(const e of l){const t=e.routePath.split("/").filter(Boolean),r={};let a=!0;for(let i=0;i<t.length;i++){const c=t[i],h=s[i];if(c.startsWith("$"))if(c==="$"){const u=s.slice(i).join("/");if(u!=="")r["*"]=u,r._splat=u;else{a=!1;break}}else{const u=c.slice(1);r[u]=h}else if(c!==h){a=!1;break}}if(a)return{routePath:e.routePath,params:r,payload:e.payload}}}const f=P.filter(o=>o.$APIRoute);function g(o){const n=[];return o.forEach(s=>{const e=s.path.split("/").filter(Boolean).map(t=>t==="*splat"?"$":t.startsWith(":$")&&t.endsWith("?")?t.slice(1,-1):t).join("/");n.push({routePath:`/${e}`,payload:s})}),n}const S=async({request:o})=>{if(!f.length)return new Response("No routes found",{status:404});if(!m.includes(o.method))return new Response("Method not allowed",{status:405});const n=g(f),s=new URL(o.url,"http://localhost:3000"),l=R(s,n);if(!l)return new Response("Not found",{status:404});let e;try{e=await l.payload.$APIRoute.import().then(a=>a.APIRoute)}catch(a){return console.error("Error importing route file:",a),new Response("Internal server error",{status:500})}if(!e)return new Response("Internal server error",{status:500});const t=o.method,r=e.methods[t];return r?await r({request:o,params:l.params}):new Response("Method not allowed",{status:405})},v=w(S);export{v as default};
